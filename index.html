<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>SORA flight-planner webGIS</title>

  <link rel="stylesheet" href="https://js.arcgis.com/4.29/esri/themes/light/main.css" />
  <link rel="stylesheet" href="./css/app.css" />
  <script src="https://js.arcgis.com/4.29/"></script>

  <script src="./js/config.js"></script>
  <script src="./js/app.js"></script>
</head>

<body>
  <header class="topbar">
    <div class="brand">
      <img class="logo" src="./assets/spectrofly-logo.png" alt="SpectroFly" />
      <div class="titles">
        <div class="appname">SORA flight-planner webGIS</div>
        <div class="subtitle">Mission planning • CV • GRB • VLOS</div>
      </div>
    </div>
    <div id="authStatus">Not signed in</div>
  </header>

  <div id="viewDiv"></div>
  <!-- Right-side tools panel -->
  <div id="toolsPanel" class="tools-panel">
    <div class="tools-title">Tools</div>

    <details open class="tools-group" id="secLayers">
      <summary>Layers</summary>
      <div id="widgetLayerList" class="tools-section"></div>
    </details>

    <details class="tools-group" id="secBasemaps">
      <summary>Basemaps</summary>
      <div id="widgetBasemap" class="tools-section"></div>
    </details>

    <details class="tools-group" id="secBookmarks">
      <summary>Bookmarks</summary>
      <div id="widgetBookmarks" class="tools-section"></div>
    </details>

    <details open class="tools-group" id="secMission">
      <summary>Mission planning</summary>

      <div class="tools-section">
        <div class="hint" style="margin-bottom:8px;">
          Import GeoJSON or draw a mission polygon. Then generate buffers.
        </div>

        <button id="btnImportGeoJSON" class="measure-btn">Import mission (GeoJSON)</button>
        <input id="fileGeoJSON" type="file" accept=".geojson,.json,application/geo+json" style="display:none;" />

        <button id="btnDrawMission" class="measure-btn">Draw mission area</button>
        <button id="btnClearMission" class="measure-btn">Clear mission</button>

        <div style="margin-top:12px; font-weight:600;">Drone</div>

        <select id="droneSelect" style="width:100%; margin-bottom:8px;">
          <option value="">-- Select drone --</option>
          <option value="m350">DJI M350</option>
          <option value="tundra2">Tundra 2 Endurance</option>
        </select>

        <div id="droneInfo" style="font-size:12px; margin-bottom:8px;"></div>

        <div style="font-weight:600;">Operational inputs</div>

        <label style="font-size:12px;">Acquisition speed (m/s)</label>
        <input id="inputSpeed" type="number" value="10" style="width:100%; margin-bottom:6px;" />

        <label style="font-size:12px;">Altitude AGL (m)</label>
        <input id="inputAltitude" type="number" value="60" style="width:100%; margin-bottom:6px;" />

        <label style="font-size:12px;">
          <input type="checkbox" id="chkParachute" />
          Use parachute contingency method
        </label>

        <button id="btnCalculateCV" class="measure-btn" style="margin-top:8px;">
          Calculate CV + GRB
        </button>

        <div style="margin-top:10px; font-weight:600;">Quick test buffer</div>
        <button id="btnBuffer100" class="measure-btn">Generate 100 m buffer</button>

        <div id="missionStatus" style="font-size:12px; opacity:0.8; margin-top:8px;"></div>
      </div>
    </details>  

    <details class="tools-group">
      <summary>Measure</summary>
      
      <div class="tools-section">
        <div id="measureButtons"></div>
        <div id="measureWidget"></div>
      </div>
    </details>
</div>
</body>
</html>
